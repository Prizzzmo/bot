
# Исторический образовательный бот для Telegram

Интерактивный образовательный бот для Telegram, предоставляющий глубокие знания об истории России. Проект включает в себя структурированное представление исторических тем, интерактивное тестирование знаний, визуализацию исторических событий и интеллектуальные беседы по историческим вопросам.

## Содержание

1. [Обзор проекта](#обзор-проекта)
2. [Ключевые возможности](#ключевые-возможности)
3. [Архитектура решения](#архитектура-решения)
4. [Технологии и компоненты](#технологии-и-компоненты)
5. [Установка и настройка](#установка-и-настройка)
6. [API интеграции](#api-интеграции)
7. [Тестирование](#тестирование)
8. [Руководство по расширению](#руководство-по-расширению)
9. [Безопасность](#безопасность)
10. [Перспективы развития](#перспективы-развития)

## Обзор проекта

Образовательный бот по истории России — это инновационная интерактивная платформа, реализованная в виде Telegram-бота с использованием современных технологий искусственного интеллекта. Проект создан для популяризации изучения истории России, предоставления доступного и структурированного образовательного контента, а также поддержки интерактивного диалога с пользователями.

Бот разработан с использованием модульной архитектуры, что обеспечивает высокую расширяемость, поддерживаемость и производительность. Интеграция с Google Gemini API позволяет генерировать качественный образовательный контент и вести интеллектуальные беседы на исторические темы.

## Ключевые возможности

### 1. Изучение тем по истории России
- **Структурированный выбор тем**: Широкий спектр готовых тем, охватывающих все ключевые периоды и события российской истории
- **Персонализированный подход**: Возможность для пользователей запрашивать информацию по собственным темам
- **Многоуровневый анализ**: Каждая тема представлена в 5 логических разделах, раскрывающих различные аспекты

### 2. Интерактивное тестирование
- **Адаптивная генерация тестов**: Уникальные наборы вопросов с различным уровнем сложности для каждой темы
- **Интеллектуальная проверка знаний**: Автоматическая оценка ответов с подробными пояснениями
- **Персонализированная аналитика**: Рекомендации по дальнейшему обучению на основе результатов тестирования

### 3. Исторические карты и визуализации
- **Интерактивные карты сражений**: Визуализация важных исторических битв и кампаний
- **Динамические исторические карты**: Отображение изменений границ государства в разные периоды
- **Временные линии**: Наглядное представление хронологии ключевых событий

### 4. Аналитическая система
- **Мониторинг образовательного прогресса**: Детальная статистика по изученным темам и пройденным тестам
- **Интеллектуальные рекомендации**: Персонализированные предложения по изучению связанных тем
- **Полноценная аналитическая панель**: Углубленный анализ образовательного процесса пользователя

### 5. Административный интерфейс
- **Веб-панель управления**: Полноценный мониторинг и управление работой бота
- **Расширенная система логирования**: Гибкая фильтрация и анализ событий
- **Статистика использования**: Аналитика популярности тем и активности пользователей

## Архитектура решения

Проект реализован на основе модульной архитектуры с четким разделением ответственности между компонентами:

```
┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐
│  Telegram API   │◄───►│    Bot Core     │◄───►│   Gemini API    │
└─────────────────┘     └─────────────────┘     └─────────────────┘
                               ▲
                               │
                 ┌─────────────┴─────────────┐
                 │                           │
        ┌────────▼────────┐        ┌────────▼────────┐
        │  CommandHandlers │        │  ContentService │
        └─────────────────┘        └─────────────────┘
                 ▲                           ▲
                 │                           │
      ┌──────────┴──────────┐     ┌─────────┴─────────┐
      │                     │     │                   │
┌─────▼─────┐         ┌────▼────┐ │ ┌───────────┐    │
│UIManager  │         │APIClient │ │ │APICache   │    │
└───────────┘         └─────────┘ │ └───────────┘    │
      ▲                    ▲      │       ▲          │
      │                    │      │       │          │
      └────────┬───────────┘      └────┬──┘          │
               │                       │             │
        ┌──────▼──────┐         ┌─────▼─────┐┌────────▼────────┐
        │MessageManager│         │TextCache  ││AnalyticsService│
        └─────────────┘         └───────────┘└─────────────────┘
               ▲                                     ▲
               │                                     │
        ┌──────▼──────┐                     ┌────────▼────────┐
        │Logger       │                     │HistoryMapService│
        └─────────────┘                     └─────────────────┘
```

## Технологии и компоненты

Система состоит из следующих ключевых компонентов:

1. **Bot Core** (`src/bot.py`) - Центральный компонент, ответственный за инициализацию и управление ботом
2. **API Client** (`src/api_client.py`) - Клиент для взаимодействия с Google Gemini API
3. **Content Service** (`src/content_service.py`) - Сервис для управления историческим контентом
4. **Test Service** (`src/test_service.py`) - Сервис для генерации и проверки тестов
5. **Conversation Service** (`src/conversation_service.py`) - Сервис для обработки интеллектуальных бесед
6. **UI Manager** (`src/ui_manager.py`) - Компонент для создания пользовательского интерфейса
7. **Analytics Service** (`src/analytics.py`) - Сервис для сбора и анализа образовательной статистики
8. **History Map** (`src/history_map.py`) - Сервис для работы с историческими картами и визуализациями
9. **Message Manager** (`src/message_manager.py`) - Компонент для эффективного управления сообщениями
10. **Logger** (`src/logger.py`) - Система расширенного и структурированного логирования

### Базовые технологии:
- **Python 3.9+**: Основной язык разработки
- **Telegram Bot API**: Платформа для взаимодействия с пользователями
- **Google Gemini Pro API**: Продвинутая модель искусственного интеллекта для генерации контента
- **Flask**: Фреймворк для реализации административного веб-интерфейса

### Паттерны проектирования:
- **Модульная архитектура**: Четкое разделение ответственности между компонентами
- **Factory**: Система создания и настройки компонентов
- **Service Locator**: Централизованное управление сервисами
- **Dependency Injection**: Гибкое управление зависимостями
- **Strategy**: Выбор различных алгоритмов обработки данных
- **Observer**: Реализация событийной модели взаимодействия компонентов

## Установка и настройка

### Требования

- Python 3.9+
- Telegram Bot Token
- Google Gemini API ключ
- Доступ к интернету для работы с API

### Установка зависимостей

```bash
pip install -r requirements.txt
```

### Настройка переменных окружения

Создайте файл `.env` в корневой директории проекта:

```
TELEGRAM_TOKEN=your_telegram_token_here
GEMINI_API_KEY=your_gemini_api_key_here
ADMIN_ID=your_telegram_id
ENABLE_WEB_INTERFACE=true
WEB_INTERFACE_PORT=5000
```

### Запуск бота

```bash
python main.py
```

Для запуска с веб-интерфейсом:

```bash
python run_combined.py
```

## API интеграции

Бот интегрируется с Google Gemini API для генерации высококачественного образовательного контента:

- Структурированная информация по историческим темам
- Интеллектуальные тесты с вариантами ответов
- Ответы на вопросы в режиме беседы
- Валидация исторических тем и фактов

### Оптимизация работы с API:

1. **Настройка параметров генерации**:
   - Низкая температура (0.1-0.3) для фактологических ответов
   - Высокая температура (0.7) для творческих заданий
   - Динамический контроль объема для оптимизации качества ответов

2. **Структурированные промпты**:
   - Специализированные шаблоны для различных типов контента
   - Контекстуальное обогащение запросов
   - Двухуровневая проверка релевантности информации

3. **Интеллектуальное кэширование**:
   - LRU-кэш для оптимизации производительности
   - Асинхронное сохранение в персистентное хранилище
   - Валидация кэша с контролем актуальности данных

## Тестирование

Проект включает комплексную систему тестирования:

```bash
python -m unittest discover tests
```

### Типы тестов:
- **Модульные тесты**: Для отдельных компонентов системы
- **Интеграционные тесты**: Для взаимодействия между компонентами
- **Функциональные тесты**: Для проверки пользовательских сценариев
- **Нагрузочные тесты**: Для проверки производительности системы

## Руководство по расширению

### Добавление новой команды

1. Создайте метод-обработчик в `src/handlers.py`
2. Зарегистрируйте команду в `setup()` в `src/bot.py`
3. При необходимости добавьте новое состояние в `src/config.py`
4. Добавьте новую кнопку в соответствующее меню через `src/ui_manager.py`

### Создание нового сервиса

1. Создайте новый класс сервиса, наследующийся от `BaseService`
2. Реализуйте интерфейс с необходимыми методами
3. Зарегистрируйте сервис в `src/factory.py`
4. Добавьте сервис в контейнер в `src/service_container.py`

## Безопасность

### Защита данных:
- Минимизация сбора пользовательских данных
- Анонимизация запросов к внешним API
- Автоматическая очистка истории диалогов
- Строгая изоляция пользовательских сессий

### Безопасность API:
- Безопасное хранение ключей в переменных окружения
- Валидация и санитизация всех входных данных
- Интеллектуальное лимитирование частоты запросов
- Защита от несанкционированного доступа

### Контроль контента:
- Проверка релевантности запросов исторической тематике
- Многоуровневая фильтрация некорректных запросов
- Мониторинг и анализ подозрительной активности
- Логирование и аудит критических действий

## Перспективы развития

1. **Расширение образовательных возможностей**:
   - Интеграция мультимедийного контента (аудио, видео, интерактивные карты)
   - Система адаптивного обучения с учетом индивидуального прогресса
   - Интерактивные исторические симуляции и ролевые игры
   - Коллаборативные образовательные возможности

2. **Технологические улучшения**:
   - Интеграция с более продвинутыми моделями искусственного интеллекта
   - Реализация полноценной образовательной платформы с веб-интерфейсом
   - Расширенная система аналитики с элементами предиктивного анализа
   - Оптимизация для работы с увеличивающимся объемом данных

3. **Расширение охвата**:
   - Мультиязычная поддержка и адаптация контента
   - Специализированные версии для различных образовательных групп
   - Интеграция с образовательными учреждениями и платформами
   - Расширение исторического контекста на мировую историю

---

*© 2025 Образовательный бот по истории России*
